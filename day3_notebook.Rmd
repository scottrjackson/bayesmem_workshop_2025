---
title: "Bayesian Modeling and Simulation: Day 3"
date: 2025-08-20
---

# Agenda

- Review, recap
- Spend some more time playing with priors, etc. with a simple model
- Start using `brms` to fit MEMs, comparing with `lme4`
- Discuss the challenges of parameterization

# Review & recap

- Michael's question about "between Bayesian and Frequentist"
- walk through the "simple regression" Stan file
- Spend a little more time playing with priors and other settings

# Load some packages

```{r}
library(tidyverse)
library(rstan)
library(rstanarm)
library(bayesplot)
library(lme4)
library(HistData)
library(brms)

```



```{r}
# fit plain lm() for comparison
galton_lm <- lm(child ~ 1 + parent, Galton)
summary(galton_lm)
```

Basic Stan model

```{r}
galton_data <- list(
  N = nrow(Galton),
  x = Galton$parent,
  y = Galton$child,
  location_intercept = 25,
  scale_intercept = 100,
  scale_slope = 20
)

galton_stan <- stan(
  file = "simple_regression_newpars.stan",
  data = galton_data,
  chains = 4,
  iter = 2000,
  warmup = 1000
  # refresh = 0 # suppresses progress
)

mcmc_trace(galton_stan)

```

```{r}
galton_stan_warm10 <- stan(
  file = "simple_regression_newpars.stan",
  data = galton_data,
  chains = 4,
  iter = 2000,
  warmup = 10
  # refresh = 0 # suppresses progress
)

mcmc_trace(galton_stan_warm10)
```

Using new model with place for specifying the mean of the prior on slope

```{r}
galton_data <- list(
  N = nrow(Galton),
  x = Galton$parent,
  y = Galton$child,
  location_intercept = 23.9,
  scale_intercept = 100,
  location_slope = 0,
  scale_slope = 20
)

galton_stan <- stan(
  file = "simple_regression_newpars.stan",
  data = galton_data,
  chains = 4,
  iter = 2000,
  warmup = 1000
  #refresh = 0 # if you don't want to see progress
)

summary(galton_stan, pars = c("intercept", "slope"))$summary

galton_posterior <- data.frame(slope = extract(galton_stan)$slope)

ggplot(galton_posterior, aes(slope)) + geom_density()

```



# The `brms` package and adventures in parameterization


# Fitting MEMs with `brms` and Stan


